# Agentic Crawler ä»•æ§˜æ›¸

## æ¦‚è¦

Agentic Crawlerã¯ã€SwiftAgentãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ãŸAIé§†å‹•ã®Webã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã§ã™ã€‚Ollamaã‚’ä½¿ç”¨ã—ã¦ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’åˆ†æã—ã€**ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯å……è¶³åº¦åˆ¤å®š**ã«ã‚ˆã£ã¦æƒ…å ±åé›†ã®å®Œäº†ã‚’åˆ¤æ–­ã—ã¾ã™ã€‚å›ºå®šã®æœ€å¤§ãƒšãƒ¼ã‚¸æ•°ã‚„æ·±åº¦åˆ¶é™ã‚’ä½¿ç”¨ã›ãšã€LLMãŒç›®çš„ã«å¯¾ã—ã¦ååˆ†ãªæƒ…å ±ãŒé›†ã¾ã£ãŸã‹ã‚’è©•ä¾¡ã—ã¾ã™ã€‚

## ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | å½¹å‰² |
|-----------|------|
| **SwiftAgent** | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚Step-basedè¨­è¨ˆã®åŸºç›¤ |
| **Selenops** | Webã‚¯ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã®åŸºç›¤ï¼ˆCrawlerDelegateï¼‰ |
| **Remark** | å…¨ã¦ã®Webã‚¢ã‚¯ã‚»ã‚¹ã€‚HTMLâ†’Markdownå¤‰æ› |
| **OpenFoundationModels-Ollama** | LLMåˆ†æï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç†è§£ãƒ»ãƒªãƒ³ã‚¯å„ªå…ˆåº¦æ±ºå®šãƒ»å……è¶³åº¦åˆ¤å®šï¼‰ |

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AgenticCrawler                                â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  SearchOrchestratorStep                         â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  ç›®çš„ (objective)                                               â”‚ â”‚
â”‚  â”‚       â†“                                                         â”‚ â”‚
â”‚  â”‚  1. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ (Ollama)                                     â”‚ â”‚
â”‚  â”‚       â†“                                                         â”‚ â”‚
â”‚  â”‚  2. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã”ã¨ã« SearchStep â†’ DeepCrawlStep                 â”‚ â”‚
â”‚  â”‚       â†“                                                         â”‚ â”‚
â”‚  â”‚  3. å……è¶³åº¦ãƒã‚§ãƒƒã‚¯ (Ollama)                                     â”‚ â”‚
â”‚  â”‚       â†“ ä¸ååˆ†ãªã‚‰è¿½åŠ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ç¹°ã‚Šè¿”ã—                       â”‚ â”‚
â”‚  â”‚  4. æœ€çµ‚ã‚µãƒãƒªãƒ¼ç”Ÿæˆ                                            â”‚ â”‚
â”‚  â”‚       â†“                                                         â”‚ â”‚
â”‚  â”‚  AggregatedResult                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     SearchStep     â”‚       â”‚       DeepCrawlStep            â”‚   â”‚
â”‚  â”‚                    â”‚       â”‚                                â”‚   â”‚
â”‚  â”‚  Keyword (æ–‡å­—åˆ—)  â”‚       â”‚  URL + Objective               â”‚   â”‚
â”‚  â”‚       â†“            â”‚       â”‚       â†“                        â”‚   â”‚
â”‚  â”‚  æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³       â”‚ â”€â”€â”€â”€â†’ â”‚  ãƒšãƒ¼ã‚¸ãƒ•ã‚§ãƒƒãƒ + Ollamaåˆ†æ    â”‚   â”‚
â”‚  â”‚       â†“            â”‚       â”‚       â†“                        â”‚   â”‚
â”‚  â”‚  [URLs]            â”‚       â”‚  é–¢é€£ãƒªãƒ³ã‚¯ã‚’æ·±æ˜ã‚Š             â”‚   â”‚
â”‚  â”‚                    â”‚       â”‚       â†“                        â”‚   â”‚
â”‚  â”‚  (Remarkä½¿ç”¨)      â”‚       â”‚  DeepCrawlResult               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 CrawlCandidateStack                           â”‚   â”‚
â”‚  â”‚           (å„ªå…ˆåº¦ä»˜ãã‚¯ãƒ­ãƒ¼ãƒ«å€™è£œã‚¹ã‚¿ãƒƒã‚¯)                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    MemoryStorage                              â”‚   â”‚
â”‚  â”‚              (åé›†ã—ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸€æ™‚ä¿å­˜)                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

#### 1. SearchOrchestratorStep

ç›®çš„ã‹ã‚‰ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆã€æ¤œç´¢ã€ã‚¯ãƒ­ãƒ¼ãƒ«ã€å……è¶³åº¦åˆ¤å®šã¾ã§ã‚’ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãƒ¡ã‚¤ãƒ³Stepã€‚

```swift
public struct SearchOrchestratorStep: Step, Sendable {
    typealias Input = SearchQuery
    typealias Output = AggregatedResult
}

public struct SearchQuery: Sendable {
    let objective: String        // èª¿æŸ»ç›®çš„
    let maxVisitedURLs: Int      // è¨ªå•URLæ•°ã®ä¸Šé™ï¼ˆã‚»ãƒ¼ãƒ•ãƒ†ã‚£ãƒªãƒŸãƒƒãƒˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 50ï¼‰
}
```

**å‡¦ç†ãƒ•ãƒ­ãƒ¼:**
1. ç›®çš„ã‹ã‚‰ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆï¼ˆOllama - å¿…è¦ãªæ•°ã ã‘è‡ªå‹•ç”Ÿæˆï¼‰
2. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã”ã¨ã«æ¤œç´¢ãƒ»DeepCrawlï¼ˆæ¤œç´¢çµæœã¯å…¨ã¦å–å¾—ï¼‰
3. å……è¶³åº¦ãƒã‚§ãƒƒã‚¯ï¼ˆOllamaï¼‰- ä¸ååˆ†ãªã‚‰è¿½åŠ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ç¶™ç¶š
4. æœ€çµ‚ã‚µãƒãƒªãƒ¼ç”Ÿæˆ

#### 2. SearchStep

æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰URLãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹Stepã€‚

```swift
public struct SearchStep: Step, Sendable {
    typealias Input = KeywordSearchInput
    typealias Output = [URL]
}

public struct KeywordSearchInput: Sendable {
    let keyword: String
}
```

**ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°:**
- æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³å†…éƒ¨ãƒªãƒ³ã‚¯ã‚’é™¤å¤–ï¼ˆGoogleå…¨TLDã€Bingã€DuckDuckGoã€Yahooã€Yandexã€Baiduï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æŒ‡å®šã®ãƒ–ãƒ­ãƒƒã‚¯ãƒªã‚¹ãƒˆå¯¾å¿œ
- HTTPSã®ã¿è¨±å¯

#### 3. DeepCrawlStep

1ã¤ã®URLã‹ã‚‰é–¢é€£ãƒªãƒ³ã‚¯ã‚’æ·±æ˜ã‚Šã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹Stepã€‚

```swift
public struct DeepCrawlStep: Step, Sendable {
    typealias Input = DeepCrawlInput
    typealias Output = DeepCrawlResult
}

public struct DeepCrawlInput: Sendable {
    let url: URL
    let objective: String
    let missingInformation: [String]  // ä¸è¶³æƒ…å ±ï¼ˆå„ªå…ˆãƒªãƒ³ã‚¯é¸æŠã«æ´»ç”¨ï¼‰
}
```

**å‡¦ç†ãƒ•ãƒ­ãƒ¼:**
1. åˆæœŸURLã‚’ãƒ•ã‚§ãƒƒãƒã—ã¦åˆ†æ
2. é–¢é€£åº¦ãƒã‚§ãƒƒã‚¯ï¼ˆ0.4æœªæº€ã¯ç„¡é–¢ä¿‚ã¨ã—ã¦æ—©æœŸçµ‚äº†ï¼‰
3. é–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä¿å­˜
4. å„ªå…ˆãƒªãƒ³ã‚¯ã‚’ã‚¹ã‚¿ãƒƒã‚¯ã«è¿½åŠ 
5. ã‚¹ã‚¿ãƒƒã‚¯ãŒç©ºã«ãªã‚‹ã¾ã§æ·±æ˜ã‚Šç¶™ç¶š

#### 4. AgenticCrawlerDelegate

Ollamaã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ†æãƒ»ãƒªãƒ³ã‚¯å„ªå…ˆåº¦æ±ºå®šã‚’è¡Œã†CrawlerDelegateã€‚

```swift
public actor AgenticCrawlerDelegate: CrawlerDelegate {
    // çµ±åˆã•ã‚ŒãŸè¨ªå•è¨˜éŒ²ãƒ¡ã‚½ãƒƒãƒ‰
    public func recordVisit(url: URL)

    // Remarkã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç›´æ¥å‡¦ç†
    public func processRemark(_ remark: Remark, at url: URL) async

    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—
    public func getStatus() -> CrawlerStatus
}

public struct CrawlerStatus: Sendable {
    let pagesVisited: Int    // è¨ªå•ã—ãŸãƒšãƒ¼ã‚¸æ•°
    let pagesSaved: Int      // ä¿å­˜ã—ãŸãƒšãƒ¼ã‚¸æ•°ï¼ˆé–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã¿ï¼‰
    let isComplete: Bool
    let elapsedTime: TimeInterval
}
```

#### 5. CrawlCandidateStack

å„ªå…ˆåº¦ä»˜ãã‚¯ãƒ­ãƒ¼ãƒ«å€™è£œã‚’ç®¡ç†ã™ã‚‹Actorã€‚

```swift
public actor CrawlCandidateStack {
    func push(_ candidate: CrawlCandidate)
    func push(_ candidates: [CrawlCandidate])
    func pop() -> CrawlCandidate?
    func pop(count: Int) -> [CrawlCandidate]
    var count: Int { get async }
}
```

#### 6. ContentInsight

Ollamaã«ã‚ˆã‚‹ãƒšãƒ¼ã‚¸åˆ†æçµæœã€‚

```swift
public struct ContentInsight: Sendable {
    let url: URL
    let summary: String              // ãƒšãƒ¼ã‚¸ã®è¦ç´„
    let relevanceScore: Double       // ç›®çš„ã¨ã®é–¢é€£åº¦ï¼ˆ0.0ã€œ1.0ï¼‰
    let keyFindings: [String]        // ä¸»è¦ãªç™ºè¦‹
    let nextCandidates: [CrawlCandidate]  // æ¬¡ã«ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã¹ãå€™è£œ
}
```

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### CrawlCandidate

```swift
public struct CrawlCandidate: Sendable, Comparable {
    let url: URL
    let score: Double          // 0.0ã€œ1.0ï¼ˆé«˜ã„ã»ã©å„ªå…ˆï¼‰
    let title: String?
    let reason: String?        // ã‚¹ã‚³ã‚¢ã®ç†ç”±
    let sourceURL: URL?        // ã“ã®ãƒªãƒ³ã‚¯ã‚’ç™ºè¦‹ã—ãŸãƒšãƒ¼ã‚¸
}
```

### CrawledContent

```swift
public struct CrawledContent: Identifiable, Sendable {
    let id: UUID
    let url: URL
    let title: String?
    let description: String?
    let markdown: String
    let links: [ExtractedLink]
    let crawledAt: Date
}
```

### çµ±è¨ˆæƒ…å ±

```swift
// DeepCrawlçµ±è¨ˆ
public struct DeepCrawlStatistics: Sendable {
    let pagesVisited: Int   // è¨ªå•ã—ãŸãƒšãƒ¼ã‚¸æ•°
    let pagesSaved: Int     // ä¿å­˜ã—ãŸãƒšãƒ¼ã‚¸æ•°ï¼ˆé–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã¿ï¼‰
    let linksFound: Int
    let duration: Duration
}

// é›†ç´„çµ±è¨ˆ
public struct AggregatedStatistics: Sendable {
    let totalPagesVisited: Int   // è¨ªå•ã—ãŸãƒšãƒ¼ã‚¸ç·æ•°
    let totalPagesSaved: Int     // ä¿å­˜ã—ãŸãƒšãƒ¼ã‚¸ç·æ•°
    let irrelevantURLsSkipped: Int
    let keywordsUsed: Int
    let duration: Duration
}
```

## å‡¦ç†ãƒ•ãƒ­ãƒ¼

### 1. ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚§ãƒ¼ã‚º (SearchOrchestratorStep)

```
å…¥åŠ›: SearchQuery(objective: "Swift Concurrencyã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹")
  â†“
1. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ (Ollama)
   â†’ ["Swift Concurrency best practices", "async await patterns", ...]
  â†“
2. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã”ã¨ã«å‡¦ç†
   â”Œâ”€ ãƒ«ãƒ¼ãƒ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  a. SearchStep: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ â†’ URLä¸€è¦§              â”‚
   â”‚  b. DeepCrawlStep: å„URLã‚’ä¸¦åˆ—ã§æ·±æ˜ã‚Š            â”‚
   â”‚  c. çµæœã‚’é›†ç´„                                    â”‚
   â”‚  d. å……è¶³åº¦ãƒã‚§ãƒƒã‚¯ (Ollama)                       â”‚
   â”‚     - ååˆ† â†’ ãƒ«ãƒ¼ãƒ—çµ‚äº†                           â”‚
   â”‚     - ä¸ååˆ† â†’ ä¸è¶³æƒ…å ±ã¨è¿½åŠ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
3. æœ€çµ‚ã‚µãƒãƒªãƒ¼ç”Ÿæˆ (Ollama)
  â†“
å‡ºåŠ›: AggregatedResult
```

### 2. æ¤œç´¢ãƒ•ã‚§ãƒ¼ã‚º (SearchStep)

```
å…¥åŠ›: KeywordSearchInput(keyword: "Swift Concurrency")
  â†“
æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³URLç”Ÿæˆ (DuckDuckGo/Google/Bing)
  â†“
Remark.fetch() â†’ Markdownå–å¾—
  â†“
extractLinks() â†’ ãƒªãƒ³ã‚¯æŠ½å‡º
  â†“
ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°:
  - æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³å†…éƒ¨ãƒªãƒ³ã‚¯é™¤å¤–
  - ãƒ–ãƒ­ãƒƒã‚¯ãƒªã‚¹ãƒˆé™¤å¤–
  - HTTPSã®ã¿
  - é‡è¤‡é™¤å»
  â†“
å‡ºåŠ›: [URL1, URL2, URL3, ...]
```

### 3. æ·±æ˜ã‚Šãƒ•ã‚§ãƒ¼ã‚º (DeepCrawlStep)

```
å…¥åŠ›: DeepCrawlInput(url: URL, objective: "...")
  â†“
1. åˆæœŸURLã‚’ãƒ•ã‚§ãƒƒãƒ (Remark)
  â†“
2. Ollamaã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ†æ
   - é–¢é€£åº¦ã‚¹ã‚³ã‚¢
   - è¦ç´„
   - å„ªå…ˆãƒªãƒ³ã‚¯
  â†“
3. é–¢é€£åº¦ãƒã‚§ãƒƒã‚¯ (é–¾å€¤: 0.4)
   - < 0.4: ç„¡é–¢ä¿‚ã¨ã—ã¦çµ‚äº†ï¼ˆä¿å­˜ã—ãªã„ï¼‰
   - >= 0.4: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä¿å­˜ã€å„ªå…ˆãƒªãƒ³ã‚¯ã‚’ã‚¹ã‚¿ãƒƒã‚¯ã«è¿½åŠ 
  â†“
4. æ·±æ˜ã‚Šãƒ«ãƒ¼ãƒ—
   â”Œâ”€ ã‚¹ã‚¿ãƒƒã‚¯ãŒç©ºã«ãªã‚‹ã¾ã§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  a. ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰å€™è£œã‚’å–å¾—                    â”‚
   â”‚  b. ãƒ•ã‚§ãƒƒãƒ + åˆ†æ                          â”‚
   â”‚  c. é–¢é€£åº¦ >= 0.4 ãªã‚‰ä¿å­˜ + ãƒªãƒ³ã‚¯è¿½åŠ        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
å‡ºåŠ›: DeepCrawlResult
```

### 4. å……è¶³åº¦åˆ¤å®š (Ollama)

```
ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èª¿æŸ»ç›®çš„: {objective}                           â”‚
â”‚                                                 â”‚
â”‚ ã“ã‚Œã¾ã§ã«åé›†ã—ãŸæƒ…å ±:                          â”‚
â”‚ ã€ã‚½ãƒ¼ã‚¹1ã€‘è¦ç´„: ... ç™ºè¦‹: ...                  â”‚
â”‚ ã€ã‚½ãƒ¼ã‚¹2ã€‘è¦ç´„: ... ç™ºè¦‹: ...                  â”‚
â”‚ ...                                             â”‚
â”‚                                                 â”‚
â”‚ åˆ¤æ–­ã—ã¦ãã ã•ã„:                                â”‚
â”‚ - isSufficient: ååˆ†ãªæƒ…å ±ãŒã‚ã‚‹ã‹              â”‚
â”‚ - missingInformation: ä¸è¶³ã—ã¦ã„ã‚‹æƒ…å ±          â”‚
â”‚ - suggestedKeywords: è¿½åŠ æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Ollamaã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ†æ

```
ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èª¿æŸ»ç›®çš„: {objective}                           â”‚
â”‚ ä¸è¶³æƒ…å ±: {missingInformation}ï¼ˆã‚ã‚Œã°ï¼‰        â”‚
â”‚                                                 â”‚
â”‚ ç¾åœ¨ã®ãƒšãƒ¼ã‚¸:                                    â”‚
â”‚ - ã‚¿ã‚¤ãƒˆãƒ«: {title}                              â”‚
â”‚ - URL: {url}                                    â”‚
â”‚ - å†…å®¹: {markdown(5000æ–‡å­—ã¾ã§)}                 â”‚
â”‚                                                 â”‚
â”‚ ç™ºè¦‹ã•ã‚ŒãŸãƒªãƒ³ã‚¯:                                â”‚
â”‚ [1] {link1.text} -> {link1.url}                â”‚
â”‚ [2] {link2.text} -> {link2.url}                â”‚
â”‚ ...                                             â”‚
â”‚                                                 â”‚
â”‚ è©•ä¾¡åŸºæº–:                                        â”‚
â”‚ - 0.8ã€œ1.0: ç›®çš„ã«ç›´æ¥ç­”ãˆã‚‹å…·ä½“çš„æƒ…å ±           â”‚
â”‚ - 0.5ã€œ0.7: é–¢é€£ã™ã‚‹è£œè¶³æƒ…å ±                     â”‚
â”‚ - 0.3ã€œ0.4: ã‚ãšã‹ã«è§¦ã‚Œã¦ã„ã‚‹ã ã‘               â”‚
â”‚ - 0.0ã€œ0.2: ç›®çš„ã«ç­”ãˆã‚‹æƒ…å ±ãŒãªã„               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³

```swift
public struct CrawlerConfiguration: Sendable {
    let searchEngine: SearchEngine      // .duckDuckGo, .google, .bing
    let requestDelay: Duration          // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: .milliseconds(500)
    let ollamaModel: String             // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: "llama3.2"
    let ollamaBaseURL: URL              // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: http://localhost:11434
    let allowedDomains: [String]?       // nilã®å ´åˆã¯åˆ¶é™ãªã—
    let blockedDomains: [String]        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: []
}
```

**æ³¨æ„:** `maxDepth`ã¨`maxPages`ã¯å‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚ã‚¯ãƒ­ãƒ¼ãƒ«ã®çµ‚äº†ã¯LLMã«ã‚ˆã‚‹ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯å……è¶³åº¦åˆ¤å®šã§æ±ºå®šã•ã‚Œã¾ã™ã€‚

## CLI ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

```bash
# ç›®çš„ãƒ™ãƒ¼ã‚¹ã®æ¤œç´¢ãƒ»ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆæ¨å¥¨ï¼‰
crawler-cli search "Swift Concurrency best practices"

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³æŒ‡å®š
crawler-cli search "Swift Concurrency" \
  --limit 100 \
  --model gpt-oss:20b \
  --format json

# ç‰¹å®šã®URLã‹ã‚‰æ·±æ˜ã‚Šã‚¯ãƒ­ãƒ¼ãƒ«
crawler-cli crawl https://developer.apple.com/swift/ \
  --objective "Swift 6ã®æ–°æ©Ÿèƒ½ã‚’åé›†" \
  --model gpt-oss:20b
```

### ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰

```bash
# æ¤œç´¢ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ†ã‚¹ãƒˆï¼ˆå…¨æ¤œç´¢çµæœã‚’å–å¾—ï¼‰
crawler-cli test-search "Swift Concurrency"

# ãƒ•ã‚§ãƒƒãƒã®ãƒ†ã‚¹ãƒˆ
crawler-cli test-fetch https://example.com

# LLMåˆ†æã®ãƒ†ã‚¹ãƒˆ
crawler-cli test-analyze https://example.com "Swift Concurrencyã®æƒ…å ±ã‚’åé›†"
```

### å‡ºåŠ›ä¾‹

```
ğŸ¯ Objective: Swift Concurrency best practices
ğŸ”‘ Generated keywords: ["Swift Concurrency best practices", ...]

ğŸ” Searching: Swift Concurrency best practices
   Found 5 URLs

ğŸ“„ Deep crawling: https://example.com/swift-concurrency
   ğŸ“Š [0.85] Swift Concurrency Guide
   âœ… Deep crawl complete: 3 visited, 2 saved

ğŸ“Š After keyword 'Swift Concurrency best practices':
   Visited: 15/50, Saved: 8
   Irrelevant URLs skipped: 3

âœ… Sufficient information gathered

ğŸ Crawl complete!
   Visited: 15, Saved: 8
   Keywords used: 2
   Duration: 45.3s

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š Aggregated Crawl Results
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Objective: Swift Concurrency best practices
ğŸ”‘ Keywords used: Swift Concurrency best practices, async await patterns

ğŸ“ˆ Statistics:
   â€¢ Pages visited: 15
   â€¢ Pages saved: 8
   â€¢ Irrelevant URLs skipped: 3
   â€¢ Keywords used: 2
   â€¢ Duration: 45s

ğŸ” Top Insights:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[85%] https://example.com/swift-concurrency
     Comprehensive guide to Swift Concurrency
     â€¢ Structured concurrency with async/await
     â€¢ Task groups for parallel execution
```

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### CrawlerError

```swift
public enum CrawlerError: Error, Sendable {
    case searchFailed(String)
    case fetchFailed(URL, String)
    case ollamaUnavailable
    case invalidConfiguration(String)
    case timeout
    case noURLsFound
    case invalidURL(String)
    case cancelled
}
```

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
Sources/
â”œâ”€â”€ AgenticCrawler/
â”‚   â”œâ”€â”€ Configuration/
â”‚   â”‚   â””â”€â”€ CrawlerConfiguration.swift
â”‚   â”œâ”€â”€ Delegate/
â”‚   â”‚   â””â”€â”€ AgenticCrawlerDelegate.swift
â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”œâ”€â”€ CrawlCandidate.swift
â”‚   â”‚   â”œâ”€â”€ CrawledContent.swift
â”‚   â”‚   â”œâ”€â”€ CrawlerError.swift
â”‚   â”‚   â”œâ”€â”€ GenerableModels.swift      # @Generable LLMãƒ¬ã‚¹ãƒãƒ³ã‚¹
â”‚   â”‚   â””â”€â”€ StepModels.swift           # Stepå…¥å‡ºåŠ›ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ Steps/
â”‚   â”‚   â”œâ”€â”€ CrawlerStep.swift
â”‚   â”‚   â”œâ”€â”€ DeepCrawlStep.swift
â”‚   â”‚   â”œâ”€â”€ SearchOrchestratorStep.swift
â”‚   â”‚   â””â”€â”€ SearchStep.swift
â”‚   â””â”€â”€ Storage/
â”‚       â”œâ”€â”€ CrawlCandidateStack.swift
â”‚       â””â”€â”€ MemoryStorage.swift
â””â”€â”€ CrawlerCLI/
    â””â”€â”€ CrawlerCLI.swift

Tests/
â””â”€â”€ AgenticCrawlerTests/
    â””â”€â”€ MemoryStorageTests.swift
```

## è¨­è¨ˆåŸå‰‡

### ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯çµ‚äº†æ¡ä»¶

å¾“æ¥ã®ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã¯`maxPages`ã€`maxDepth`ã€`maxKeywords`ã€`maxURLs`ãªã©ã®å›ºå®šåˆ¶é™ã§çµ‚äº†ã‚’åˆ¶å¾¡ã—ã¾ã™ãŒã€Agentic Crawlerã¯**LLMã«ã‚ˆã‚‹ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯å……è¶³åº¦åˆ¤å®š**ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

- ã€Œç›®çš„ã«å¯¾ã—ã¦ååˆ†ãªæƒ…å ±ãŒé›†ã¾ã£ãŸã‹ã€ã‚’LLMãŒåˆ¤æ–­
- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®æ•°ã‚‚ã€æ¤œç´¢çµæœã®æ•°ã‚‚ã€LLMãŒé©åˆ‡ã¨åˆ¤æ–­ã™ã‚‹é‡ã‚’ä½¿ç”¨
- ä¸è¶³æƒ…å ±ã‚’ç‰¹å®šã—ã€è¿½åŠ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆ
- ç„¡é–¢ä¿‚ãªãƒšãƒ¼ã‚¸ã¯æ—©æœŸã‚¹ã‚­ãƒƒãƒ—ï¼ˆãƒªã‚½ãƒ¼ã‚¹ç¯€ç´„ï¼‰

### ã‚»ãƒ¼ãƒ•ãƒ†ã‚£ãƒªãƒŸãƒƒãƒˆ

`maxVisitedURLs`ï¼ˆCLI: `--limit`ï¼‰ã¯**ã‚»ãƒ¼ãƒ•ãƒ†ã‚£ãƒªãƒŸãƒƒãƒˆ**ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚ã“ã‚Œã¯LLMã®åˆ¤æ–­ãƒŸã‚¹ã‚„ç„¡é™ãƒ«ãƒ¼ãƒ—ã‚’é˜²ããŸã‚ã®å®‰å…¨å¼ã§ã‚ã‚Šã€é€šå¸¸ã®çµ‚äº†æ¡ä»¶ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤: 50
- LLMãŒå……è¶³ã¨åˆ¤æ–­ã™ã‚‹å‰ã«ã“ã®ä¸Šé™ã«é”ã—ãŸå ´åˆã€ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å¼·åˆ¶çµ‚äº†
- é€šå¸¸ã¯ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯å……è¶³åº¦åˆ¤å®šãŒå…ˆã«åƒã„ã¦çµ‚äº†ã™ã‚‹

### çµ±è¨ˆã®åˆ†é›¢

- **pagesVisited**: å®Ÿéš›ã«è¨ªå•ï¼ˆãƒ•ã‚§ãƒƒãƒï¼‰ã—ãŸãƒšãƒ¼ã‚¸æ•°
- **pagesSaved**: é–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ã—ã¦ä¿å­˜ã—ãŸãƒšãƒ¼ã‚¸æ•°

ã“ã®åˆ†é›¢ã«ã‚ˆã‚Šã€ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã®åŠ¹ç‡æ€§ï¼ˆé–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å‰²åˆï¼‰ã‚’è©•ä¾¡ã§ãã¾ã™ã€‚

## ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

1. **æ°¸ç¶šåŒ–ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸** - SQLite/CoreDataå¯¾å¿œ
2. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½** - å–å¾—æ¸ˆã¿ãƒšãƒ¼ã‚¸ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
3. **ãƒ¬ãƒ¼ãƒˆåˆ¶é™** - ãƒ‰ãƒ¡ã‚¤ãƒ³ã”ã¨ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™
4. **èªè¨¼å¯¾å¿œ** - Basicèªè¨¼/OAuthå¯¾å¿œã‚µã‚¤ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ«
5. **JavaScriptå¯¾å¿œ** - SPAã‚µã‚¤ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆWebKitçµ±åˆï¼‰
6. **ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµæœè¡¨ç¤º
