import Foundation
import SwiftAgent

// MARK: - Persona Generation Response

/// Response from persona generation.
///
/// The LLM generates diverse personas for a given research domain.
@Generable
public struct PersonaGenerationResponse: Sendable {
    @Guide(description: "生成されたペルソナのリスト")
    public let personas: [GeneratedPersona]
}

/// Individual persona generated by LLM.
@Generable
public struct GeneratedPersona: Sendable {
    @Guide(description: "職業・役割（例：ソフトウェアエンジニア、医療研究者）")
    public let role: String

    @Guide(description: "専門レベル")
    public let expertiseLevel: ExpertiseLevel

    @Guide(description: "このペルソナが持つ情報ニーズ（3-5項目）")
    public let informationNeeds: [String]

    @Guide(description: "このペルソナが持つ制約（時間、言語、専門性など）")
    public let constraints: [String]
}

// MARK: - Task Generation Response

/// Response from task generation for a persona.
///
/// The LLM generates research tasks based on persona characteristics.
@Generable
public struct TaskGenerationResponse: Sendable {
    @Guide(description: "生成されたタスクのリスト")
    public let tasks: [GeneratedTask]
}

/// Individual task generated by LLM.
@Generable
public struct GeneratedTask: Sendable {
    @Guide(description: "研究目的（ユーザーが入力するクエリ形式）")
    public let objective: String

    @Guide(description: "具体的な要件（3-5項目）")
    public let requirements: [String]

    @Guide(description: "期待する出力形式")
    public let expectedFormat: OutputFormat

    @Guide(description: "タスクの難易度")
    public let difficulty: DifficultyLevel

    @Guide(description: "最新情報が必要かどうか")
    public let requiresRecentInfo: Bool
}

// MARK: - Task Qualification Response

/// Response from task qualification check.
///
/// Stage 1: Determines if the task requires recent information.
@Generable
public struct TaskQualificationResponse: Sendable {
    @Guide(description: "タスクが最新の検索情報を必要とするか")
    public let requiresRecentInfo: Bool

    @Guide(description: "判断理由")
    public let reasoning: String

    @Guide(description: "情報の鮮度がどの程度重要か（0.0〜1.0）", .range(0.0...1.0))
    public let recencyImportance: Double
}

// MARK: - Search Necessity Response

/// Response from search necessity check.
///
/// Stage 2: Determines if the task requires web search beyond LLM knowledge.
@Generable
public struct SearchNecessityResponse: Sendable {
    @Guide(description: "LLMの知識だけでは解決できないか")
    public let requiresSearch: Bool

    @Guide(description: "検索の必要性スコア（0.0〜1.0）", .range(0.0...1.0))
    public let necessityScore: Double

    @Guide(description: "判断理由")
    public let reasoning: String

    @Guide(description: "LLMだけで答えられる部分があれば記述")
    public let knownInformation: String
}
